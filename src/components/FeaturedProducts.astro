---
// FeaturedProducts4.astro — responsive AVIF/WebP sin JPG

const items = {
  spotlight:  { name: "Heart Box — 30 Bonbons", slug: "heart-gift-box",               imgBase: "/images/heart-30",     tag: "Gift Favorite" },
  topWide:    { name: "Classic Box — 9",        slug: "classic-box-9",                 imgBase: "/images/classic-9",    tag: "Best Seller" },
  bottomLeft: { name: "Pistachio Crunch Bar",   slug: "dark-60-pistachio",             imgBase: "/images/pistachiobar", tag: "Nut Lover" },
  bottomRight:{ name: "Mix Gift",               slug: "golden-ribbon-keepsake-box",    imgBase: "/images/mix-gift",     tag: "Gift Mix" }
};

// helper para srcset con sufijos -480 -768 -1080 
const srcset = (base: string, ext: string, widths: number[]) =>
  widths.map((w) => `${base}-${w}.${ext} ${w}w`).join(", ");

// tamaños por bloque (ajustados a tu layout reportado)
const sizesSpotlight = "(min-width:1024px) 40vw, 92vw"; // izq
const sizesTopWide   = "(min-width:1024px) 58vw, 92vw"; // arriba der
const sizesBottom    = "(min-width:640px) 44vw, 92vw";  // tarjetas inf.

// dimensiones intrínsecas (evitar CLS)
const whSquare = { w: 1200, h: 1200 };   // spotlight
const whWide   = { w: 1400, h: 1120 };   // ~5:4
---

<div class="py-5 px-4 sm:py-6 sm:px-6 lg:py-8 lg:px-12 xl:px-20 bg-[color:var(--cacao,#0A0B0D)] rounded-2xl shadow-lg shadow-[12px_15px_30px_rgba(255,216,0,.58)]">
  <h2 class="mx-auto mb-5 sm:mb-6 text-center font-serif font-semibold tracking-tight text-[clamp(1.8rem,4vw,3rem)] text-white drop-shadow-[0_2px_12px_rgba(0,0,0,.35)]">
    Featured Products
  </h2>

  <div class="flex flex-col lg:flex-row justify-center gap-2 sm:gap-3 lg:gap-5 max-w-7xl mx-auto">

    <!-- IZQUIERDA: SPOTLIGHT -->
    <div
      class="relative isolate w-full lg:w-[40%] flex flex-col rounded-xl border border-white/10 bg-[radial-gradient(110%_70%_at_50%_0%,rgba(255,199,83,.10),transparent_55%)]/[color:var(--card,#0e0f12)] p-3.5 overflow-hidden min-h-[380px]"
      style="content-visibility:auto; contain-intrinsic-size: 720px 420px;"
    >
      <div class="z-20">
        <span class="inline-flex items-center rounded-full px-2 py-0.5 text-[0.68rem] font-bold bg-white/10 text-white/80 border border-white/15">{items.spotlight.tag}</span>
        <h3 class="mt-1 font-serif text-[clamp(1.05rem,1.5vw,1.25rem)] leading-snug text-stone-50">
          {items.spotlight.name}
        </h3>
      </div>

      <!-- Imagen -->
      <div class="absolute left-1/2 -translate-x-1/2 top-4 lg:top-8  w-[94%] lg:w-full xl:w-[116%] max-w-[840px]">
        <div class="relative aspect-square">
          <picture>
            <source type="image/avif" srcset={srcset(items.spotlight.imgBase, "avif", [480,768,1080])} sizes={sizesSpotlight} />
            <source type="image/webp" srcset={srcset(items.spotlight.imgBase, "webp", [480,768,1080])} sizes={sizesSpotlight} />
            <!-- fallback en WEBP (no JPG) -->
            <img
              src={`${items.spotlight.imgBase}-768.webp`}
              alt={items.spotlight.name}
              width={whSquare.w} height={whSquare.h}
              loading="lazy" decoding="async" fetchpriority="low"
              class="absolute inset-0 object-contain w-full h-full transition-transform duration-700 ease-out hover:scale-[1.045]"
              style="@media(hover:hover){filter:drop-shadow(0 26px 60px rgba(0,0,0,.55));}"
            />
          </picture>
        </div>
      </div>

      <!-- BOTÓN UNIFICADO -->
      <div class="mt-auto sm:absolute sm:left-3 sm:bottom-2.5 inline-flex items-center gap-2 z-40">
        <a href={`/shop/${items.spotlight.slug}`} class="inline-flex items-center gap-2 rounded-xl px-3.5 py-2 text-sm font-semibold bg-white/90 text-stone-900 hover:bg-white transition-colors duration-300">
          View Product
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M5 12h14M12 5l7 7-7 7"/></svg>
        </a>
      </div>
    </div>

    <!-- DERECHA: GRID -->
    <div class="w-full lg:w-[60%] grid grid-rows-[auto_1fr] gap-3 lg:gap-5">

      <!-- TOP WIDE -->
      <div
        class="relative isolate w-full flex flex-col rounded-xl border border-stone-100/15 bg-stone-900/40 p-3 overflow-hidden min-h-[280px] sm:min-h-[320px]"
        style="content-visibility:auto; contain-intrinsic-size: 980px 360px;"
      >
        <div class="z-30 max-w-[58%] pr-2">
          <span class="inline-flex items-center rounded-full px-2 py-0.5 text-[0.68rem] font-bold bg-stone-100/10 text-stone-200 border border-stone-100/15">{items.topWide.tag}</span>
          <h3 class="mt-1 font-serif text-[1.02rem] lg:text-[1.12rem] leading-snug text-stone-50">
            {items.topWide.name}
          </h3>
        </div>

        <div class="mx-auto my-0.5 w-[104%] sm:absolute sm:right-3 sm:top-1/2 sm:-translate-y-1/2 sm:w-[72%] lg:right-5 lg:w-[93%]">
          <div class="relative aspect-[5/4]">
            <picture>
              <source type="image/avif" srcset={srcset(items.topWide.imgBase, "avif", [480,768,1080])} sizes={sizesTopWide} />
              <source type="image/webp" srcset={srcset(items.topWide.imgBase, "webp", [480,768,1080])} sizes={sizesTopWide} />
              <img
                src={`${items.topWide.imgBase}-768.webp`}
                alt={items.topWide.name}
                width={whWide.w} height={whWide.h}
                loading="lazy" decoding="async" fetchpriority="low"
                class="absolute inset-0 object-contain w-full h-full transition-transform duration-700 ease-out hover:scale-[1.045]"
                style="@media(hover:hover){filter:drop-shadow(0 18px 45px rgba(0,0,0,.45));}"
              />
            </picture>
          </div>
        </div>

        <!-- BOTÓN UNIFICADO -->
        <div class="mt-auto sm:absolute sm:left-3 sm:bottom-2.5 lg:left-4 lg:bottom-3 inline-flex items-center gap-2 z-40">
          <a href={`/shop/${items.topWide.slug}`} class="inline-flex items-center gap-2 rounded-xl px-3.5 py-2 text-sm font-semibold bg-white/90 text-stone-900 hover:bg-white transition-colors duration-300">
            View Product
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M5 12h14M12 5l7 7-7 7"/></svg>
          </a>
        </div>
      </div>

      <!-- BOTTOM ROW -->
      <div class="grid grid-cols-1 sm:grid-cols-2 gap-3 lg:gap-5">

        <!-- BOTTOM LEFT -->
        <div
          class="relative isolate flex flex-col rounded-xl border border-stone-100/15 bg-stone-900/40 p-3 overflow-hidden min-h-[250px] sm:min-h-[290px]"
          style="content-visibility:auto; contain-intrinsic-size: 640px 300px;"
        >
          <div class="z-30 max-w-[70%] pr-2">
            <span class="inline-flex items-center rounded-full px-2 py-0.5 text-[0.68rem] font-bold bg-stone-100/10 text-stone-200 border border-stone-100/15">{items.bottomLeft.tag}</span>
            <h3 class="mt-1 font-serif text-[1rem] leading-snug text-stone-50">{items.bottomLeft.name}</h3>
          </div>

          <div class="mx-auto w-[94%] sm:absolute sm:right-3 sm:bottom-2 sm:w-[80%] lg:right-4 lg:w-[89%]">
            <div class="relative aspect-[5/4]">
              <picture>
                <source type="image/avif" srcset={srcset(items.bottomLeft.imgBase, "avif", [480,768,1080])} sizes={sizesBottom} />
                <source type="image/webp" srcset={srcset(items.bottomLeft.imgBase, "webp", [480,768,1080])} sizes={sizesBottom} />
                <img
                  src={`${items.bottomLeft.imgBase}-768.webp`}
                  alt={items.bottomLeft.name}
                  width={whWide.w} height={whWide.h}
                  loading="lazy" decoding="async" fetchpriority="low"
                  class="absolute inset-0 object-contain w-full h-full transition-transform duration-700 ease-out hover:scale-[1.045]"
                  style="@media(hover:hover){filter:drop-shadow(0 16px 40px rgba(0,0,0,.45));}"
                />
              </picture>
            </div>
          </div>

          <!-- BOTÓN UNIFICADO -->
          <div class="mt-auto sm:absolute sm:left-3 sm:bottom-2.5 inline-flex items-center gap-2 z-40">
            <a href={`/shop/${items.bottomLeft.slug}`} class="inline-flex items-center gap-2 rounded-xl px-3.5 py-2 text-sm font-semibold bg-white/90 text-stone-900 hover:bg-white transition-colors duration-300">
              View Product
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M5 12h14M12 5l7 7-7 7"/></svg>
            </a>
          </div>
        </div>

        <!-- BOTTOM RIGHT -->
        <div
          class="relative isolate flex flex-col rounded-xl border border-stone-100/15 bg-gradient-to-br from-emerald-900 via-emerald-700 to-emerald-400 p-3 overflow-hidden min-h-[250px] sm:min-h-[290px]"
          style="content-visibility:auto; contain-intrinsic-size: 640px 300px;"
        >
          <div class="z-30 max-w-[70%] pr-2 text-white">
            <span class="inline-flex items-center rounded-full px-2 py-0.5 text-[0.68rem] font-bold bg-white/15 text-white border border-white/25">{items.bottomRight.tag}</span>
            <h3 class="mt-1 font-serif text-[1rem] leading-snug text-white">{items.bottomRight.name}</h3>
          </div>

          <div class="mx-auto w-[94%] sm:absolute sm:right-3 sm:top-[15%] sm:w-[82%] lg:right-5 lg:w-[86%] -rotate-12">
            <div class="relative aspect-[5/4]">
              <picture>
                <source type="image/avif" srcset={srcset(items.bottomRight.imgBase, "avif", [480,768,1080])} sizes={sizesBottom} />       
                <source type="image/webp" srcset={srcset(items.bottomRight.imgBase, "webp", [480,768,1080])} sizes={sizesBottom} />
                <img
                  src={`${items.bottomRight.imgBase}-768.webp`}
                  alt={items.bottomRight.name}
                  width={whWide.w} height={whWide.h}
                  loading="lazy" decoding="async" fetchpriority="low"
                  class="absolute inset-0 object-contain w-full h-full transition-transform duration-700 ease-out hover:scale-[1.045]"
                  style="@media(hover:hover){filter:drop-shadow(0 16px 40px rgba(0,0,0,.45));}"
                />
              </picture>
            </div>
          </div>

          <!-- BOTÓN UNIFICADO -->
          <div class="mt-auto sm:absolute sm:left-3 sm:bottom-2.5 inline-flex items-center gap-2 z-40">
            <a href={`/shop/${items.bottomRight.slug}`} class="inline-flex items-center gap-2 rounded-xl px-3.5 py-2 text-sm font-semibold bg-white/90 text-stone-900 hover:bg-white transition-colors duration-300">
              View Product
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M5 12h14M12 5l7 7-7 7"/></svg>
            </a>
          </div>
        </div>

      </div>
    </div>
  </div>

  <!-- CTA global -->
  <div class="mt-12 flex justify-center">
    <a href="/shop" class="inline-flex items-center gap-2 rounded-xl px-5 py-3 text-base sm:text-lg font-semibold bg-white/90 text-stone-900 hover:bg-white shadow-[0_8px_25px_rgba(227,184,110,.25)] transition-transform hover:-translate-y-0.5">
      Shop All Products
      <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M5 12h14M12 5l7 7-7 7"/></svg>
    </a>
  </div>
</div>
