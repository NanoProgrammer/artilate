---
/**
 * ArtilateSections.astro
 * Testimonials (carousel con avatars por iniciales) + 4 craft steps
 * Dark cacao theme, gold accents, EN only, CRO-first copy.
 */

const testimonials = [
  { name: "Gloria Guilbert", role: "Local Guide", location: "Calgary, AB", text: "Delicious and beautiful chocolates! The bonbons look stunning and taste even better.", rating: 5 },
  { name: "José Solisaga", role: "Customer", location: "Calgary, AB", text: "You can actually taste real ingredients. Glossy shells, clean flavours — totally worth it if you love good chocolate.", rating: 5 },
  { name: "Abigail Slingerlend", role: "Customer", location: "Calgary, AB", text: "Silky, smooth, perfectly balanced — honestly the best chocolate I’ve ever had.", rating: 5 },
  { name: "Jacob LaPointe", role: "Customer", location: "Airdrie, AB", text: "Tried the passion fruit — it was delicious. Sweet and tangy with a nice gentle bite at the end!", rating: 5 },
  { name: "Ashley Hannan", role: "Local", location: "Calgary, AB", text: "Amazing, elegant, LOCAL. Creative flavours with beautiful finishes. Gift-ready presentation.", rating: 5 },
  { name: "Igor Rupyshev", role: "Customer", location: "Calgary, AB", text: "Really amazing — recommend the big box because you won’t get enough of them!", rating: 5 },

  // CRO social proof extra
  { name: "Renee Park", role: "Event Planner", location: "Downtown Calgary, AB", text: "Elevated our client reception. The pistachio–hazelnut praliné disappeared first — people asked where we got them all night.", rating: 5 },
  { name: "Matt Thompson", role: "Corporate Buyer", location: "Red Deer, AB", text: "Polished look, clean snap, not overly sweet. Exactly what we want for premium gifting — feels boutique and thoughtful.", rating: 5 },
  { name: "Priya Nair", role: "Bride", location: "Okotoks, AB", text: "We used Artilate boxes as wedding favours — gorgeous shells, vibrant flavours. Guests literally said, “Where do we order?”", rating: 5 },
  { name: "Ethan Williams", role: "Coffee Bar Owner", location: "Kensington, Calgary", text: "Pairs beautifully with our single-origin espresso. Passion fruit and Huila coffee bonbons are a conversation starter.", rating: 5 },
  { name: "Samantha Li", role: "Verified Customer", location: "Airdrie, AB", text: "You see the gloss, then the crisp snap, then the filling… wow. Real fruit, real depth. Zero compromise.", rating: 5 },
  { name: "Daniel Brooks", role: "Dad & Gift-Giver", location: "NW Calgary, AB", text: "Birthday box for my wife — the presentation alone is luxury. She said it’s the best chocolate she’s had in Canada.", rating: 5 },
  { name: "Carmen Alvarez", role: "Food Blogger", location: "Banff, AB", text: "The finish is flawless and the fillings pop. Not a generic ‘sweet’ — layered flavour, like fine pastry in bonbon form.", rating: 5 },
  { name: "Jordan McKenzie", role: "Wine Consultant", location: "Calgary, AB", text: "Stands up to bold reds and dessert wines. Citrus notes sing; nutty pralinés are ridiculously good with tawny port.", rating: 5 },

  // Cortos y punchy
  { name: "Fabian Aguilar", role: "Customer", location: "Calgary Area", text: "Very good quality and very friendly service. Recommended for the whole Calgary area.", rating: 5 },
  { name: "Sule Lilugu", role: "Customer", location: "Calgary, AB", text: "Loved the passion fruit chocolate! Bright, real fruit flavour.", rating: 5 },
];

// Gradientes para los fondos de avatar (rotan por índice para variedad)
const avatarGradients = [
  "linear-gradient(135deg, rgba(212,163,115,.22), rgba(245,158,11,.12))",
  "linear-gradient(135deg, rgba(212,163,115,.18), rgba(212,163,115,.10))",
  "linear-gradient(135deg, rgba(245,158,11,.18), rgba(212,163,115,.10))",
  "linear-gradient(135deg, rgba(233,194,125,.20), rgba(212,163,115,.10))",
];

---

<!-- ========================== SECTION 1/5: TESTIMONIALS ========================== -->
<section id="testimonials" class="relative isolate bg-[#0A0B0D] text-[#FAFAF9]" aria-labelledby="testimonials-title">
  <div class="pointer-events-none absolute inset-0 -z-10 [background:radial-gradient(900px_440px_at_20%_28%,rgba(212,163,115,0.08),transparent_60%)]"></div>

  <div class="mx-auto w-full max-w-[120rem] px-6 lg:px-12 py-16 lg:py-24">
    <div class="mx-auto max-w-3xl text-center">
      <p class="text-[10px] tracking-[0.28em] uppercase text-white/60">What Customers Say</p>
      <h2 id="testimonials-title" class="mt-2 font-serif text-[clamp(2rem,5vw,3.4rem)] font-bold leading-tight">
        Loved by the <span class="bg-gradient-to-br from-[#D4A373] to-amber-500 bg-clip-text text-transparent">Calgary Area</span>
      </h2>
      <p class="mt-4 text-white/80">
        Real reviews from Airdrie, Calgary, Red Deer and beyond — flavour-first bonbons with glossy shells and vibrant fillings.
      </p>
    </div>

    <!-- Carousel -->
    <div class="mt-10 relative overflow-hidden">
      <div data-c-root class="relative">
        <div data-c-track class="flex transition-transform duration-700 ease-out will-change-transform">
          {testimonials.map((t, i) => (
            <div class="w-full md:w-1/2 xl:w-1/3 shrink-0 px-3">
              <article class="h-full rounded-xl border border-white/10 bg-[#0B0E11]/80 p-6 shadow-[0_18px_50px_rgba(0,0,0,.45)] backdrop-blur transition hover:-translate-y-1">
                <div class="flex items-start gap-4">
                  <!-- Avatar por iniciales -->
                  <div
                    class="avatar-initials ring-1 ring-white/10"
                    aria-hidden="true"
                    title={t.name}
                    style={{ background: avatarGradients[i % avatarGradients.length] }}
                  >
                    {t.name
                      .split(' ')
                      .filter(Boolean)
                      .map(p => p[0])
                      .slice(0,2)
                      .join('')
                      .toUpperCase()}
                  </div>

                  <div class="min-w-0">
                    <h3 class="text-sm font-semibold">{t.name}</h3>
                    <p class="text-[11px] text-white/60">{t.role} — {t.location}</p>
                  </div>
                </div>

                <p class="mt-3 text-sm md:text-[0.98rem] text-white/90">{t.text}</p>
                <div class="mt-3 text-[#D4A373]" aria-label={`${t.rating} out of 5 stars`}>
                  {"★★★★★".slice(0, t.rating)}
                </div>
              </article>
            </div>
          ))}
        </div>

        <!-- Dots -->
        <div class="absolute inset-x-0 -bottom-8 flex justify-center gap-2">
          {testimonials.map((_, i) => (
            <span class="h-1.5 w-4 rounded-full bg-white/18 data-[active=true]:bg-[#D4A373]" data-c-dot data-index={i}></span>
          ))}
        </div>
      </div>

      <!-- CRO CTA -->
      <div class="mt-12 flex flex-col items-center gap-2">
        <a href="/shop" class="inline-flex items-center gap-2 underline px-5 py-2.5 text-sm font-semibold text-[#F6EADB] transition">
          Order Now
          <svg class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
            <path d="M5 12h14M13 5l6 7-6 7" stroke-linecap="round" stroke-linejoin="round" />
          </svg>
        </a>
        <p class="text-xs text-white/60">Freshly made after you order · Gift-ready presentation</p>
      </div>
    </div>
  </div>
</section>



<style>
  :root{
    --cacao:#0A0B0D;
    --ivory:#FAFAF9;
    --gold:#D4A373;
    --amber:#F59E0B;
  }

  /* Avatar por iniciales */
  .avatar-initials{
    width: 48px;
    height: 48px;
    display: grid;
    place-items: center;
    border-radius: 9999px;
    font-size: 12px;
    font-weight: 800;
    letter-spacing: .5px;
    color: #F6EADB;
    box-shadow:
      inset 0 1px 0 rgba(255,255,255,.06),
      0 6px 18px rgba(0,0,0,.25);
    text-transform: uppercase;
  }
  @media (min-width: 768px){
    .avatar-initials{ width: 52px; height: 52px; font-size: 13px; }
  }

  /* Hover suave en tarjetas (sin marear) */
  @media (prefers-reduced-motion:no-preference){
    [data-c-track] article{
      transition: transform .35s ease, box-shadow .35s ease;
    }
    [data-c-track] article:hover{
      transform: translateY(-4px);
      box-shadow: 0 20px 56px rgba(0,0,0,.5);
    }
  }
</style>

<!-- ========================== SCRIPTS ========================== -->
<script>
  document.addEventListener("DOMContentLoaded", () => {
    // Responsive 3-up carousel
    const root = document.querySelector('[data-c-root]');
    const track = document.querySelector('[data-c-track]');
    const dots  = document.querySelectorAll('[data-c-dot]');
    if (root && track) {
      const cards = Array.from(track.children);
      let idx = 0;
      let perView = 3;

      const computePerView = () => {
        if (window.matchMedia('(min-width:1280px)').matches) perView = 3;
        else if (window.matchMedia('(min-width:768px)').matches) perView = 2;
        else perView = 1;
      };

      const update = () => {
        computePerView();
        const cardW = root.clientWidth / perView;
        track.style.transform = `translateX(-${idx * cardW}px)`;
        dots.forEach((d, i) => d.setAttribute('data-active', String(i === idx)));
      };

      const next = () => {
        idx = (idx + 1) % cards.length;
        update();
      };

      const ro = new ResizeObserver(update);
      ro.observe(root);
      window.addEventListener('orientationchange', update);

      // autoplay suave
      setInterval(next, 3500);
      update();
    }
  });
</script>
