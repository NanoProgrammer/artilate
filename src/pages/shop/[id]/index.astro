---
// src/pages/shop/[id].astro
import Layout from "../../../layouts/Layout.astro";
import ContextProduct from "../../../components/shop/contextProduct.jsx";
export const prerender = true;
const { id } = Astro.params;

/** Minimal catalog (extend freely). Keys must match product slugs/links used across the site */
const CATALOG = {
  /* ───────────────── BARS ───────────────── */
  "dark-75-pistachio": {
    id: "dark-75-pistachio",
    name: "75% Pistachio Crunch",
    price: 24,
    category: "Premium Dark",
    tag: "Bean-to-Bar",
    shortDesc:
      "Intensity meets texture: Colombian 75% dark chocolate with roasted Sicilian pistachios and sea salt.",
    longDesc:
      "Our 75% Pistachio Crunch bar marries fruit-forward Colombian cacao with the buttery depth of Sicilian pistachios. Each batch is conched low and slow to preserve delicate aromatics, then finished with a whisper of sea salt to brighten the finish. Expect a first bite that cracks, a second that melts, and a lingering pistachio-praline vibe that keeps you reaching back for more.",
    chips: ["Sicilian Pistachios", "Sea Salt", "Vegan"],
    cacao: "Single-origin Colombia • 75%",
    weight: "80 g",
    dietary: ["Vegan", "Gluten-free"],
    ingredients:
      "Cocoa mass*, organic cane sugar*, cocoa butter*, roasted pistachios (tree nuts), sea salt. *Cacao 75%.",
    allergens:
      "Contains tree nuts (pistachio). Made in a facility that handles milk and nuts.",
    images: [
      "/images/bars/pistachio-bar.jpg",
      "/images/bars/pistachio-detail1.jpg",
      "/images/bars/pistachio-detail2.jpg",
    ],
  },

  "dark-70-raspberry": {
    id: "dark-70-raspberry",
    name: "70% Raspberry Bliss",
    price: 22,
    category: "Fruit Infused",
    tag: "Vegan",
    shortDesc:
      "Lush 70% dark layered with freeze-dried raspberry and a breath of rose—bright, perfumed, elegant.",
    longDesc:
      "This bar starts with our house 70% dark—rounded, red-fruit forward—then folds in freeze-dried raspberries for pop and perfume. A hint of rose lifts the mid-palate, never overpowering the cacao. It’s a modern fruit bar: clean, vibrant, and quietly romantic.",
    chips: ["Freeze-Dried Raspberry", "Rose Petals", "Vegan"],
    cacao: "Single-origin Colombia • 70%",
    weight: "80 g",
    dietary: ["Vegan", "Gluten-free"],
    ingredients:
      "Cocoa mass*, organic cane sugar*, cocoa butter*, freeze-dried raspberries, rose petals. *Cacao 70%.",
    allergens: "Made in a facility that handles milk and nuts.",
    images: ["/images/bars/raspberry-bar.jpg"],
  },

  "dark-65-mixed-nuts": {
    id: "dark-65-mixed-nuts",
    name: "65% Mixed Nuts Delight",
    price: 20,
    category: "Nut Collection",
    tag: "Crowd-Pleaser",
    shortDesc:
      "Silky 65% dark lavishly studded with almonds, hazelnuts, and walnuts for a classic crunch.",
    longDesc:
      "An ode to the timeless nut bar: almonds for snap, hazelnuts for aroma, walnuts for depth—set in our silky 65% dark. Conched to a soft sheen for a clean melt and a nostalgic, shareable crunch.",
    chips: ["Almond • Hazelnut • Walnut", "Ethically Sourced"],
    cacao: "Blend • 65%",
    weight: "90 g",
    dietary: ["Gluten-free"],
    ingredients:
      "Cocoa mass, organic cane sugar, cocoa butter, almonds, hazelnuts, walnuts.",
    allergens:
      "Contains tree nuts (almond, hazelnut, walnut). Made in a facility that handles milk.",
    images: ["/images/bars/mixed-nuts-bar.jpg"],
  },

  /* ───────────────── BONBONS (grid/“Bonbons Menu”) ───────────────── */
  "classic-box-9": {
    id: "classic-box-9",
    name: "Classic Box — 9",
    price: 31,
    category: "Bonbons",
    tag: "Best Seller",
    shortDesc:
      "Nine signature bonbons spanning caramel, fruit, single-origin ganache, and praline.",
    longDesc:
      "Our crowd-pleasing set: thin, glossy shells filled with caramel, fruit-bright ganaches, velvet pralines and a single-origin dark that anchors the flight. Balanced from first bite to last.",
    chips: ["Balanced", "Gluten-free friendly"],
    cacao: "Mixed origins",
    weight: "9 bonbons",
    dietary: ["Gluten-free (not certified)"],
    ingredients:
      "Cocoa mass, sugar, cocoa butter, dairy, nuts, fruit purées, natural flavors.",
    allergens: "Contains dairy and nuts.",
    images: ["/images/bonbons/classic-9.jpg"],
  },

  "tropical-box-9": {
    id: "tropical-box-9",
    name: "Tropical Box — 9",
    price: 33,
    category: "Bonbons",
    tag: "Fruity",
    shortDesc:
      "A bright journey through tropical fruit ganaches made with real purées and citrus peels.",
    longDesc:
      "Sun-lit flavors in a neat nine: guava, passion fruit, pineapple rum and lime zest layered over silky ganaches. Juicy acidity, clean finishes, and eye-candy shells.",
    chips: ["Vegan options", "Limited batch"],
    cacao: "Colombia 70% • house blend",
    weight: "9 bonbons",
    dietary: ["May include dairy"],
    ingredients:
      "Cocoa mass, sugar, cocoa butter, dairy, fruit purées, citrus peel, natural flavors.",
    allergens: "Made in a facility that handles dairy and nuts.",
    images: ["/images/bonbons/tropical-9.jpg"],
  },

  "nut-lover-5": {
    id: "nut-lover-5",
    name: "Nut Lover Box — 5",
    price: 20,
    category: "Bonbons",
    tag: "Crunchy",
    shortDesc:
      "Pralines and gianduja with a satisfying crunch of roasted nuts.",
    longDesc:
      "Five mini sculptures of nutty bliss—hazelnut, pistachio, almond, pecan y walnut—con distintos tostados y texturas para un final largo y goloso.",
    chips: ["Praline", "Roasted Nuts"],
    cacao: "Mixed origins",
    weight: "5 bonbons",
    dietary: ["Contains nuts & dairy"],
    ingredients:
      "Cocoa mass, sugar, cocoa butter, dairy, hazelnut, pistachio, almond, pecan, walnut.",
    allergens: "Contains dairy and tree nuts.",
    images: ["/images/bonbons/nut-5.jpg"],
  },

  "floral-garden-8": {
    id: "floral-garden-8",
    name: "Floral Garden — 8",
    price: 28,
    category: "Bonbons",
    tag: "Aromatic",
    shortDesc:
      "Delicate infusions layered with cacao—soft floral notes with a long finish.",
    longDesc:
      "Un recorrido delicado por flores y cacao: rosas, lavanda y azahar sobre ganaches aireadas. Capas limpias, perfume sutil y final sedoso.",
    chips: ["Light body", "Infusions"],
    cacao: "72% dark chocolate",
    weight: "8 bonbons",
    dietary: ["Contains dairy"],
    ingredients:
      "Cocoa mass, sugar, cocoa butter, dairy, floral infusions, natural flavors.",
    allergens: "Contains dairy. Made in a facility that handles nuts.",
    images: ["/images/bonbons/floral-8.jpg"],
  },

  "mini-sampler-4": {
    id: "mini-sampler-4",
    name: "Mini Sampler — 4",
    price: 15,
    category: "Bonbons",
    tag: "Starter",
    shortDesc:
      "A small taste of our best sellers. Perfect add-on for gifts.",
    longDesc:
      "Cuatro bocados para conocer la casa: un caramelo, un frutal, un praliné y un origen oscuro. Tamaño mini, carácter grande.",
    chips: ["Gift-ready"],
    cacao: "Mixed origins",
    weight: "4 bonbons",
    dietary: ["Contains dairy"],
    ingredients:
      "Cocoa mass, sugar, cocoa butter, dairy, nuts, fruit purées.",
    allergens: "Contains dairy and nuts.",
    images: ["/images/bonbons/mini-4.jpg"],
  },

  "berry-burst-4": {
    id: "berry-burst-4",
    name: "Berry Burst — 4",
    price: 16,
    category: "Bonbons",
    tag: "Vibrant",
    shortDesc:
      "High-fruit intensity with a tart finish—tiny but powerful.",
    longDesc:
      "Pequeño set centrado en frutos rojos: frambuesa y mora en capas vivas sobre chocolate oscuro. Dulzor contenido y acidez brillante.",
    chips: ["Seasonal fruit"],
    cacao: "Peru 72%",
    weight: "4 bonbons",
    dietary: ["Contains dairy"],
    ingredients:
      "Cocoa mass, sugar, cocoa butter, dairy, raspberry, blackberry, natural flavors.",
    allergens: "Contains dairy. Made in a facility that handles nuts.",
    images: ["/images/bonbons/berry-4.jpg"],
  },

  "sea-salt-caramel-8": {
    id: "sea-salt-caramel-8",
    name: "Sea Salt Caramel — 8",
    price: 27,
    category: "Bonbons",
    tag: "Indulgent",
    shortDesc:
      "Slow-cooked caramel with Maldon sea salt in a thin dark shell.",
    longDesc:
      "Caramelo lento y mantecoso, cortado con sal marina Maldon y vestido con una cáscara fina de chocolate oscuro para el mejor contraste de snap y cremosidad.",
    chips: ["Soft center", "Maldon sea salt"],
    cacao: "72% dark chocolate",
    weight: "8 bonbons",
    dietary: ["Contains dairy"],
    ingredients:
      "Cocoa mass, sugar, cocoa butter, dairy, sea salt.",
    allergens: "Contains dairy. Made in a facility that handles nuts.",
    images: ["/images/bonbons/caramel-8.jpg"],
  },

  /* ───────────────── GIFTING (mosaic) ───────────────── */
  "ribboned-celebration-set": {
    id: "ribboned-celebration-set",
    name: "Ribboned Celebration Set",
    price: 74,
    category: "Gifting",
    tag: "Ready-to-gift",
    shortDesc:
      "9-piece bonbons + 70% dark bar. Ribboned box with handwritten card.",
    longDesc:
      "Un regalo infalible: una caja colorida de 9 piezas junto a nuestra tableta 70% más querida. Llega con cinta y tarjeta manuscrita con tu mensaje.",
    chips: ["9-piece Bonbons", "70% Bar", "Note card"],
    cacao: "Mixed origins",
    weight: "9 bonbons + 1 bar",
    dietary: ["Contains dairy & nuts"],
    ingredients:
      "Cocoa mass, sugar, cocoa butter, dairy, nuts, fruit purées, natural flavors.",
    allergens: "Contains dairy and nuts.",
    images: ["/images/gifts/celebration-collection.jpg"],
  },

  "sweetheart-duo": {
    id: "sweetheart-duo",
    name: "Sweetheart Duo",
    price: 46,
    category: "Gifting",
    tag: "Limited Bundle",
    shortDesc:
      "Caramel thins + raspberry 70% bar. A small gesture with style.",
    longDesc:
      "Láminas finas de caramelo para el ‘snap’ y la masticación justa, con una tableta 70% a la frambuesa de perfil floral. Dúo pequeño, efecto grande.",
    chips: ["Caramel Thins", "70% Raspberry Bar"],
    cacao: "Mixed origins",
    weight: "1 bar + thins",
    dietary: ["Contains dairy"],
    ingredients:
      "Cocoa mass, sugar, cocoa butter, dairy, raspberries, sea salt.",
    allergens: "Contains dairy. Made in a facility that handles nuts.",
    images: ["/images/gifts/sweetheart-duo.jpg"],
  },

  "office-thanks-trio": {
    id: "office-thanks-trio",
    name: "Office Thanks Trio",
    price: 59,
    category: "Gifting",
    tag: "Team Favorite",
    shortDesc:
      "Three bars (45% milk, 70% dark, 85% extra dark) with tasting cards.",
    longDesc:
      "Trío compacto pensado para compartir: de dulzor lácteo a intensidad extra-oscura, con mini guías de cata para romper el hielo en equipo.",
    chips: ["45% Milk", "70% Dark", "85% Extra Dark"],
    cacao: "Mixed origins",
    weight: "3 bars",
    dietary: ["Contains milk (milk bar)"],
    ingredients:
      "Cocoa mass, sugar, cocoa butter, milk powder (milk bar), emulsifier (sunflower lecithin).",
    allergens: "Contains milk. Made in a facility that handles nuts.",
    images: ["/images/gifts/office-thanks-trio.jpg"],
  },

  "luxe-bonbons-16": {
    id: "luxe-bonbons-16",
    name: "Luxe Bonbons — 16",
    price: 68,
    category: "Gifting",
    tag: "Hand-painted",
    shortDesc:
      "Sixteen artisan bonbons in a keepsake rigid box with flavor map.",
    longDesc:
      "Nuestro set más fotogénico: 16 piezas que recorren fruta, frutos secos y orígenes, en caja rígida tipo cajón con mapa de sabores reutilizable.",
    chips: ["16 pieces", "Flavor Map"],
    cacao: "Mixed origins",
    weight: "16 bonbons",
    dietary: ["Contains dairy & nuts"],
    ingredients:
      "Cocoa mass, sugar, cocoa butter, dairy, nuts, fruit purées, natural flavors.",
    allergens: "Contains dairy and nuts.",
    images: ["/images/gifts/luxe-16.jpg"],
  },

  /* ───────────────── LIMITED EDITION ───────────────── */
  "microlot-huila-72": {
    id: "microlot-huila-72",
    name: "Micro-Lot 72% Huila — Single-Farm Bar",
    price: 14,
    category: "Limited",
    tag: "Micro-lot",
    shortDesc:
      "One-farm Colombian cacao (Huila). Red fruit, panela, and cocoa nib crunch.",
    longDesc:
      "Edición numerada de un solo origen/finca en Huila, Colombia. Nariz a panela y frutos rojos; final con crujiente de nibs. Para coleccionistas de perfiles limpios.",
    chips: ["Single-farm", "Numbered sleeve"],
    weight: "55 g",
    images: ["/images/limited/microlot-huila.jpg"],
  },

  "midnight-bloom-8": {
    id: "midnight-bloom-8",
    name: "Midnight Bloom Bonbons — 8",
    price: 36,
    category: "Limited",
    tag: "Limited run",
    shortDesc:
      "Blueberry–lavender confit over vanilla bean ganache in dark shell.",
    longDesc:
      "Confit de arándano y lavanda sobre ganache de vainilla bourbon, cubierto por una cáscara oscura lustrosa. Caja satinada negra. Lote corto.",
    chips: ["Dark shell", "Satin gift box"],
    weight: "8 bonbons",
    images: ["/images/limited/midnight-bloom.jpg"],
  },

  "espresso-caramel-shards": {
    id: "espresso-caramel-shards",
    name: "Collab: Espresso Caramel Shards",
    price: 18,
    category: "Limited",
    tag: "Roaster collab",
    shortDesc:
      "Brittle shards of espresso caramel dipped in 70% dark, dusted with fine grind.",
    longDesc:
      "Bastones quebradizos de caramelo al espresso, bañados en 70% y espolvoreados con molienda fina para un golpe aromático. Hecho a mano en tandas pequeñas.",
    chips: ["Small batch", "Hand-dipped"],
    weight: "120 g",
    images: ["/images/limited/espresso-shards.jpg"],
  },

  "smoked-gianduja-thin": {
    id: "smoked-gianduja-thin",
    name: "Smoked Sea Salt Gianduja — Thin Bar",
    price: 16,
    category: "Limited",
    tag: "Numbered batch",
    shortDesc:
      "Hazelnut gianduja kissed with alder-smoked sea salt in an ultra-thin format.",
    longDesc:
      "Gianduja de avellana con un guiño de sal marina ahumada con aliso. Formato ultrafino para un ‘snap’ quirúrgico y un fundido impecable.",
    chips: ["Ultra-thin", "Alder-smoked salt"],
    weight: "50 g",
    images: ["/images/limited/gianduja-thin.jpg"],
  },

  /* ───────────────── SNACKS & MINIS ───────────────── */
  "chocolate-coins-milk": {
    id: "chocolate-coins-milk",
    name: "Chocolate Coins — Milk",
    price: 7,
    category: "Snacks",
    tag: "3-pack",
    shortDesc: "Milk chocolate coins (set of 3).",
    longDesc:
      "Moneditas de chocolate con leche, pulidas y brillantes, listas para meriendas rápidas o para decorar postres.",
    chips: ["Shareable", "Kid favorite"],
    images: ["/images/snacks/coins-milk.jpg"],
  },

  "chocolate-coins-dark": {
    id: "chocolate-coins-dark",
    name: "Chocolate Coins — Dark",
    price: 7,
    category: "Snacks",
    tag: "4-pack",
    shortDesc: "Dark chocolate coins (set of 4).",
    longDesc:
      "Versión oscura de nuestras monedas: más cacao, menos dulzor, mismo brillo irresistible.",
    chips: ["Snack size", "70% dark"],
    images: ["/images/snacks/coins-dark.jpg"],
  },

  "chocolate-dinosaurs-mix": {
    id: "chocolate-dinosaurs-mix",
    name: "Chocolate Dinosaurs — Mix",
    price: 12,
    category: "Snacks",
    tag: "4-pack",
    shortDesc: "Playful dinos in mixed chocolate.",
    longDesc:
      "Dinosaurios de leche y oscuro para meriendas juguetonas. Moldeado nítido, detalle perfecto.",
    chips: ["Playful", "Mixed choco"],
    images: ["/images/snacks/dinos-mix.jpg"],
  },

  "chocolate-dinosaurs-mini": {
    id: "chocolate-dinosaurs-mini",
    name: "Chocolate Dinosaurs — Mini",
    price: 9,
    category: "Snacks",
    tag: "3-pack",
    shortDesc: "Mini dinos for quick bites.",
    longDesc:
      "Minis que desaparecen de un bocado: ideal para bolsillos, lunch o ‘party favors’.",
    chips: ["Mini size", "Party-friendly"],
    images: ["/images/snacks/dinos-mini.jpg"],
  },

  "thin-bar-almond": {
    id: "thin-bar-almond",
    name: "Thin Bar — Almond",
    price: 6,
    category: "Snacks",
    tag: "3-pack",
    shortDesc: "Slim almond bars with a clean snap.",
    longDesc:
      "Barras delgadas con almendra tostada. Mucho ‘snap’, dulzor medido y formato perfecto para llevar.",
    chips: ["On-the-go", "Toasted almond"],
    images: ["/images/snacks/thin-bar-almond.jpg"],
  },
};

export function getStaticPaths() {
  return Object.keys(CATALOG).map((id) => ({
    params: { id },              // genera /shop/dark-75-pistachio, etc.
    props: { product: CATALOG[id] }, // pasa el producto como prop
  }));
}

const product = CATALOG[id] ?? null;

// SEO
const title = product
  ? `${product.name} | Artilate`
  : "Product not found | Artilate";
const description = product?.shortDesc ?? "Explore Artilate chocolates.";
const image = product?.images?.[0] ?? "/assets/shop-hero-og.jpg";

const breadcrumbs = [
  { href: "/", name: "Home" },
  { href: "/shop", name: "Shop" },
  ...(product ? [{ href: `/shop/${id}`, name: product.name }] : []),
];
---

<Layout title={title} description={description} image={image} breadcrumbs={breadcrumbs}>
  {
    product ? (
      <ContextProduct client:load product={product} />
    ) : (
      <section class="mx-auto max-w-5xl px-4 py-24 text-center text-zinc-200">
        <h1 class="mb-3 text-3xl font-extrabold">Product not found</h1>
        <p class="mb-6 text-zinc-400">
          We couldn’t locate that item. Try browsing the shop instead.
        </p>
        <a href="/shop" class="inline-flex items-center gap-2 rounded-lg bg-amber-400 px-4 py-2 font-extrabold text-zinc-900">
          Back to shop
        </a>
      </section>
    )
  }

  <slot name="jsonld">
    {product && (
      <script type="application/ld+json">
        {JSON.stringify({
          "@context": "https://schema.org",
          "@type": "Product",
          name: product.name,
          description: product.shortDesc,
          image: product.images,
          category: product.category,
          brand: { "@type": "Brand", name: "Artilate" },
          offers: {
            "@type": "Offer",
            availability: "https://schema.org/InStock",
            priceCurrency: "CAD",
            price: product.price,
            url: `https://artilate.ca/shop/${product.id}`,
          },
        })}
      </script>
    )}
  </slot>
</Layout>
